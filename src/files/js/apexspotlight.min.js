apex.da.apexSpotlight={pluginHandler:function(e){var t={DOT:".",SP_DIALOG:"apx-Spotlight",SP_INPUT:"apx-Spotlight-input",SP_RESULTS:"apx-Spotlight-results",SP_ACTIVE:"is-active",SP_SHORTCUT:"apx-Spotlight-shortcut",SP_ACTION_SHORTCUT:"spotlight-search",SP_RESULT_LABEL:"apx-Spotlight-label",SP_LIVE_REGION:"sp-aria-match-found",SP_LIST:"sp-result-list",KEYS:$.ui.keyCode,URL_TYPES:{redirect:"redirect",searchPage:"search-page"},ICONS:{page:"fa-window-search",search:"icon-search"},gMaxNavResult:50,gWidth:650,gHasDialogCreated:!1,gSearchIndex:[],gStaticIndex:[],gKeywords:"",gAjaxIdentifier:null,gPlaceholderText:null,gMoreCharsText:null,gNoMatchText:null,gOneMatchText:null,gMultipleMatchesText:null,gInPageSearchText:null,gEnableInPageSearch:!0,gEnableDataCache:!1,gEnablePrefillSelectedText:!1,gSubmitItemsArray:[],gKeyboardShortcutsArray:[],gResultListThemeClass:"",gIconThemeClass:"",gShowProcessing:!1,getSpotlightData:function(e){var a;if(t.gEnableDataCache&&(a=t.getSpotlightDataSessionStorage()))e(JSON.parse(a));else try{t.showWaitSpinner(),apex.server.plugin(t.gAjaxIdentifier,{pageItems:t.gSubmitItemsArray,x01:"GET_DATA"},{dataType:"json",success:function(a){apex.event.trigger("body","apexspotlight-ajax-success",a),apex.debug.log("apexSpotlight.getSpotlightData AJAX Success",a),t.gEnableDataCache&&t.setSpotlightDataSessionStorage(JSON.stringify(a)),t.hideWaitSpinner(),e(a)},error:function(a,i,o){apex.event.trigger("body","apexspotlight-ajax-error",{message:o}),apex.debug.log("apexSpotlight.getSpotlightData AJAX Error",o),t.hideWaitSpinner(),e([])}})}catch(a){apex.event.trigger("body","apexspotlight-ajax-error",{message:a}),apex.debug.log("apexSpotlight.getSpotlightData AJAX Error",a),t.hideWaitSpinner(),e([])}},getProperApexUrl:function(e,a){try{apex.server.plugin(t.gAjaxIdentifier,{x01:"GET_URL",x02:t.gKeywords,x03:e},{dataType:"json",success:function(e){apex.debug.log("apexSpotlight.getProperApexUrl AJAX Success",e),a(e)},error:function(t,i,o){apex.debug.log("apexSpotlight.getProperApexUrl AJAX Error",o),a({url:e})}})}catch(t){apex.debug.log("apexSpotlight.getProperApexUrl AJAX Error",t),a({url:e})}},setSpotlightDataSessionStorage:function(e){if(apex.storage.hasSessionStorageSupport){var t=$v("pInstance");apex.storage.getScopedSessionStorage({prefix:"apexSpotlight",useAppId:!0}).setItem(t+".data",e)}},getSpotlightDataSessionStorage:function(){var e;if(apex.storage.hasSessionStorageSupport){var t=$v("pInstance");e=apex.storage.getScopedSessionStorage({prefix:"apexSpotlight",useAppId:!0}).getItem(t+".data")}return e},showWaitSpinner:function(){t.gShowProcessing&&$("div.apx-Spotlight-icon span").removeClass().addClass("fa fa-refresh fa-anim-spin")},hideWaitSpinner:function(){t.gShowProcessing&&$("div.apx-Spotlight-icon span").removeClass().addClass("a-Icon icon-search")},getSelectedText:function(){return window.getSelection?window.getSelection().toString().trim():document.selection.createRange?document.selection.createRange().text.trim():void 0},setSelectedText:function(){var e=t.getSelectedText();e&&(t.gHasDialogCreated?$(t.DOT+t.SP_INPUT).val(e).trigger("input"):$("body").on("apexspotlight-get-data",function(){$(t.DOT+t.SP_INPUT).val(e).trigger("input")}))},handleAriaAttr:function(){var e=$(t.DOT+t.SP_RESULTS),a=$(t.DOT+t.SP_INPUT),i=e.find(t.DOT+t.SP_ACTIVE).find(t.DOT+t.SP_RESULT_LABEL).attr("id"),o=$("#"+i),n=o.text(),r=e.find("li"),l=0!==r.length,s="",g=r.filter(function(){return 0===$(this).find(t.DOT+t.SP_SHORTCUT).length}).length;$(t.DOT+t.SP_RESULT_LABEL).attr("aria-selected","false"),o.attr("aria-selected","true"),""===t.gKeywords?s=t.gPlaceholderText:0===g?s=t.gNoMatchText:1===g?s=t.gOneMatchText:g>1&&(s=g+" "+t.gMultipleMatchesText),s=n+", "+s,$("#"+t.SP_LIVE_REGION).text(s),a.attr("aria-activedescendant",i).attr("aria-expanded",l)},closeDialog:function(){$(t.DOT+t.SP_DIALOG).dialog("close")},resetSpotlight:function(){$("#"+t.SP_LIST).empty(),$(t.DOT+t.SP_INPUT).val("").focus(),t.gKeywords="",t.handleAriaAttr()},goTo:function(e,a){var i=e.data("url");switch(e.data("type")){case t.URL_TYPES.searchPage:t.inPageSearch();break;case t.URL_TYPES.redirect:i.includes("~SEARCH_VALUE~")?(t.gKeywords=t.gKeywords.replace(/:|,|"|'/g," ").trim(),i.startsWith("f?p=")?t.getProperApexUrl(i,function(e){apex.navigation.redirect(e.url)}):(i=i.replace("~SEARCH_VALUE~",t.gKeywords),apex.navigation.redirect(i))):apex.navigation.redirect(i)}t.closeDialog()},getMarkup:function(e){var a=e.title,i=e.desc||"",o=e.url,n=e.type,r=e.icon,l=e.shortcut,s=l?'<span class="'+t.SP_SHORTCUT+'" >'+l+"</span>":"",g="",p="";return(0===o||o)&&(g='data-url="'+o+'" '),n&&(g=g+' data-type="'+n+'" '),p=r.startsWith("fa-")?"fa "+r:r.startsWith("icon-")?"a-Icon "+r:"a-Icon icon-search",'<li class="apx-Spotlight-result '+t.gResultListThemeClass+' apx-Spotlight-result--page"><span class="apx-Spotlight-link" '+g+'><span class="apx-Spotlight-icon '+t.gIconThemeClass+'" aria-hidden="true"><span class="'+p+'"></span></span><span class="apx-Spotlight-info"><span class="'+t.SP_RESULT_LABEL+'" role="option">'+a+'</span><span class="apx-Spotlight-desc">'+i+"</span></span>"+s+"</span></li>"},resultsAddOns:function(e){var a=0;t.gEnableInPageSearch&&(e.push({n:t.gInPageSearchText,u:"",i:t.ICONS.page,t:t.URL_TYPES.searchPage,shortcut:"Ctrl + 1"}),a+=1);for(var i=0;i<t.gStaticIndex.length;i++)(a+=1)>9?e.push({n:t.gStaticIndex[i].n,d:t.gStaticIndex[i].d,u:t.gStaticIndex[i].u,i:t.gStaticIndex[i].i,t:t.gStaticIndex[i].t}):e.push({n:t.gStaticIndex[i].n,d:t.gStaticIndex[i].d,u:t.gStaticIndex[i].u,i:t.gStaticIndex[i].i,t:t.gStaticIndex[i].t,shortcut:"Ctrl + "+a});return e},searchNav:function(e){var a,i,o=[],n=!1,r=e.length,l=function(){return n?o:t.gSearchIndex},s=function(e,a,i){var o,n=100,r=a-1;return 0===e&&0===r?n:(-1===(o=i.indexOf(t.gKeywords))?n=n-e-r-a:n-=o,n)};for(i=0;i<e.length;i++)a=e[i],o=l().filter(function(e,t){var i=e.n.toLowerCase(),o=i.split(" ").length,n=i.search(a);return!(r>o)&&(n>-1?(e.score=s(n,o,i),!0):e.t&&e.t.search(a)>-1?(e.score=1,!0):void 0)}).sort(function(e,t){return t.score-e.score}),n=!0;return function(e){var a,i,o,n,r,l="",s={};for(e.length>t.gMaxNavResult&&(e.length=t.gMaxNavResult),a=0;a<e.length;a++)n=(i=e[a]).shortcut,o=i.t||t.URL_TYPES.redirect,r=i.i||t.ICONS.search,s={title:i.n,desc:i.d,url:i.u,icon:r,type:o},n&&(s.shortcut=n),l+=t.getMarkup(s);return l}(t.resultsAddOns(o))},search:function(e){t.gKeywords=e.trim();var a,i,o=t.gKeywords.split(" "),n=($(t.DOT+t.SP_RESULTS),[]);for(i=0;i<o.length;i++)n.push(new RegExp(apex.util.escapeRegExp(o[i]),"gi"));a=t.searchNav(n),$("#"+t.SP_LIST).html(a).find("li").each(function(e){$(this).find(t.DOT+t.SP_RESULT_LABEL).attr("id","sp-result-"+e)}).first().addClass(t.SP_ACTIVE)},createSpotlightDialog:function(e){!function(){var a,i,o,n,r=function(){var e=$("div.apx-Spotlight-results");a=e.outerHeight(),i=$("li.apx-Spotlight-result").outerHeight(),o=e.offset().top,n=a/i};$(window).on("apexwindowresized",function(){r()}),$("body").append('<div class="'+t.SP_DIALOG+'"><div class="apx-Spotlight-body"><div class="apx-Spotlight-search"><div class="apx-Spotlight-icon"><span class="a-Icon icon-search" aria-hidden="true"></span></div><div class="apx-Spotlight-field"><input type="text" role="combobox" aria-expanded="false" aria-autocomplete="none" aria-haspopup="true" aria-label="Spotlight Search" aria-owns="'+t.SP_LIST+'" autocomplete="off" autocorrect="off" spellcheck="false" class="'+t.SP_INPUT+'" placeholder="'+e+'"></div><div role="region" class="u-VisuallyHidden" aria-live="polite" id="'+t.SP_LIVE_REGION+'"></div></div><div class="'+t.SP_RESULTS+'"><ul class="apx-Spotlight-resultsList" id="'+t.SP_LIST+'" tabindex="-1" role="listbox"></ul></div></div></div>').on("input",t.DOT+t.SP_INPUT,function(){var e=$(this).val().trim(),a=e.length;0===a?t.resetSpotlight():(a>1||!isNaN(e))&&e!==t.gKeywords&&t.search(e)}).on("keydown",t.DOT+t.SP_DIALOG,function(e){var l,s,g=$(t.DOT+t.SP_RESULTS);switch(e.which){case t.KEYS.DOWN:e.preventDefault(),function(e){var o=e.find(t.DOT+t.SP_ACTIVE),l=o.index();n||r(),!o.length||o.is(":last-child")?(o.removeClass(t.SP_ACTIVE),e.find("li").first().addClass(t.SP_ACTIVE),e.animate({scrollTop:0})):function(e){if(e[0]){var t=e.offset().top;return t<0||t>a}}(o.removeClass(t.SP_ACTIVE).next().addClass(t.SP_ACTIVE))&&e.animate({scrollTop:(l-n+2)*i},0)}(g);break;case t.KEYS.UP:e.preventDefault(),function(e){var l=e.find(t.DOT+t.SP_ACTIVE),s=l.index();n||r(),!e.length||l.is(":first-child")?(l.removeClass(t.SP_ACTIVE),e.find("li").last().addClass(t.SP_ACTIVE),e.animate({scrollTop:e.find("li").length*i})):function(e){if(e[0]){var t=e.offset().top;return t>a||t<=o}}(l.removeClass(t.SP_ACTIVE).prev().addClass(t.SP_ACTIVE))&&e.animate({scrollTop:(s-1)*i},0)}(g);break;case t.KEYS.ENTER:e.preventDefault(),t.goTo(g.find("li.is-active span"),e);break;case t.KEYS.TAB:t.closeDialog()}if(e.ctrlKey){switch(l=g.find(t.DOT+t.SP_SHORTCUT).parent().get(),e.which){case 49:s=1;break;case 50:s=2;break;case 51:s=3;break;case 52:s=4;break;case 53:s=5;break;case 54:s=6;break;case 55:s=7;break;case 56:s=8;break;case 57:s=9}s&&t.goTo($(l[s-1]),e)}e.shiftKey&&e.which===t.KEYS.TAB&&t.closeDialog(),t.handleAriaAttr()}).on("click","span.apx-Spotlight-link",function(e){t.goTo($(this),e)}).on("mousemove","li.apx-Spotlight-result",function(){var e=$(this);e.parent().find(t.DOT+t.SP_ACTIVE).removeClass(t.SP_ACTIVE),e.addClass(t.SP_ACTIVE)}).on("blur",t.DOT+t.SP_DIALOG,function(e){$(t.DOT+t.SP_DIALOG).dialog("isOpen")&&$(t.DOT+t.SP_INPUT).focus()}),$(t.DOT+t.SP_DIALOG).on("keydown",function(e){var a=$(t.DOT+t.SP_INPUT);e.which===t.KEYS.ESCAPE&&(a.val()?(t.resetSpotlight(),e.stopPropagation()):t.closeDialog())}),t.gHasDialogCreated=!0}()},openSpotlightDialog:function(e){if(window.self!==window.top)return!1;t.gEnablePrefillSelectedText&&t.setSelectedText(),t.gHasDialogCreated=$(t.DOT+t.SP_DIALOG).length>0;var a=function(){var e=$(t.DOT+t.SP_DIALOG),a=window.scrollY||window.pageYOffset;e.hasClass("ui-dialog-content")&&e.dialog("isOpen")||e.dialog({width:t.gWidth,height:"auto",modal:!0,position:{my:"center top",at:"center top+"+(a+64),of:$("body")},dialogClass:"ui-dialog--apexspotlight",open:function(){apex.event.trigger("body","apexspotlight-open-dialog");$(this).css("min-height","auto").prev(".ui-dialog-titlebar").remove(),apex.navigation.beginFreezeScroll(),$(".ui-widget-overlay").on("click",function(){t.closeDialog()})},close:function(){apex.event.trigger("body","apexspotlight-close-dialog"),t.resetSpotlight(),apex.navigation.endFreezeScroll()}})};t.gHasDialogCreated?a():(t.createSpotlightDialog(t.gPlaceholderText),a(),t.getSpotlightData(function(e){t.gSearchIndex=$.grep(e,function(e){return 0==e.s}),t.gStaticIndex=$.grep(e,function(e){return 1==e.s}),apex.event.trigger("body","apexspotlight-get-data",e)})),focusElement=e},openSpotlightDialogKeyboardShortcut:function(e){Mousetrap.stopCallback=function(e,t,a){return!0},Mousetrap.prototype.stopCallback=function(e,t,a){return!1},Mousetrap.bind(t.gKeyboardShortcutsArray,function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,t.openSpotlightDialog(e)})},inPageSearch:function(e){var a=e||t.gKeywords;$("body").unmark({done:function(){t.closeDialog(),t.resetSpotlight(),$("body").mark(a,{}),apex.event.trigger("body","apexspotlight-inpage-search",{keyword:a})}})},pluginHandler:function(e){var a=t.gDynamicActionId=e.dynamicActionId,i=t.gAjaxIdentifier=e.ajaxIdentifier,o=t.gPlaceholderText=e.placeholderText,n=t.gMoreCharsText=e.moreCharsText,r=t.gNoMatchText=e.noMatchText,l=t.gOneMatchText=e.oneMatchText,s=t.gMultipleMatchesText=e.multipleMatchesText,g=t.gInPageSearchText=e.inPageSearchText,p=e.enableKeyboardShortcuts,c=e.keyboardShortcuts,d=e.submitItems,h=e.enableInPageSearch,S=t.gMaxNavResult=e.maxNavResult,u=t.gWidth=e.width,x=e.enableDataCache,T=e.spotlightTheme,f=e.enablePrefillSelectedText,P=e.showProcessing;switch(apex.debug.log("apexSpotlight.pluginHandler - dynamicActionId",a),apex.debug.log("apexSpotlight.pluginHandler - ajaxIdentifier",i),apex.debug.log("apexSpotlight.pluginHandler - placeholderText",o),apex.debug.log("apexSpotlight.pluginHandler - moreCharsText",n),apex.debug.log("apexSpotlight.pluginHandler - noMatchText",r),apex.debug.log("apexSpotlight.pluginHandler - oneMatchText",l),apex.debug.log("apexSpotlight.pluginHandler - multipleMatchesText",s),apex.debug.log("apexSpotlight.pluginHandler - inPageSearchText",g),apex.debug.log("apexSpotlight.pluginHandler - enableKeyboardShortcuts",p),apex.debug.log("apexSpotlight.pluginHandler - keyboardShortcuts",c),apex.debug.log("apexSpotlight.pluginHandler - submitItems",d),apex.debug.log("apexSpotlight.pluginHandler - enableInPageSearch",h),apex.debug.log("apexSpotlight.pluginHandler - maxNavResult",S),apex.debug.log("apexSpotlight.pluginHandler - width",u),apex.debug.log("apexSpotlight.pluginHandler - enableDataCache",x),apex.debug.log("apexSpotlight.pluginHandler - spotlightTheme",T),apex.debug.log("apexSpotlight.pluginHandler - enablePrefillSelectedText",f),apex.debug.log("apexSpotlight.pluginHandler - showProcessing",P),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),t.gEnableInPageSearch="Y"==h,t.gEnableDataCache="Y"==x,t.gEnablePrefillSelectedText="Y"==f,t.gShowProcessing="Y"==P,d&&(t.gSubmitItemsArray=d.split(",")),"Y"==p&&(t.gKeyboardShortcutsArray=c.split(",")),T){case"ORANGE":t.gResultListThemeClass="apx-Spotlight-result-orange",t.gIconThemeClass="apx-Spotlight-icon-orange";break;case"RED":t.gResultListThemeClass="apx-Spotlight-result-red",t.gIconThemeClass="apx-Spotlight-icon-red";break;case"DARK":t.gResultListThemeClass="apx-Spotlight-result-dark",t.gIconThemeClass="apx-Spotlight-icon-dark"}"Y"==p?t.openSpotlightDialogKeyboardShortcut():t.openSpotlightDialog()}};t.pluginHandler(e)}};